/*eslint no-console: 0, "quotes": [0, "single"], module: 0, globals:[0, "obj"]*/
/*eslint no-unused-vars: ["error", { "args": "none" }]*/
/**
"f010006g": {
	"title": "Токены",
	"info": "Получить список токенов (инентификаторов сеанса/устройства)",
	"example body": {},
	"example return": {}
},
 */
'use strict';
exports.fun = function (client, obj, db) {
	return new Promise(function (resolve, reject) {
		if (!(client.idToken)) {
			resolve({ "result": false });
			return;
		}
		if (obj.user) {
			db.query(`SELECT 
			t_id as id,
			u_id,
			t_name,
			t_key,
			t_info,
			t_fcm,
			t_type,
			extract(epoch from t_mtime)::integer as t_mtime
		FROM trade.token WHERE u_id=$1;`, [obj.user]).then(
				(value) => {
					resolve({ "data": value });
				});
		} else if (true) {
			db.query(`SELECT 
			t_id as id,
			u_id,
			t_name,
			t_key,
			t_info,
			t_fcm,
			t_type,
			extract(epoch from t_mtime)::integer as t_mtime
		FROM trade.token;`, []).then(
				(value) => {
					resolve({ "data": value });
				});
		}

	});
};